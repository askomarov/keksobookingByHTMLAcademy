{"version":3,"sources":["webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/popup.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/get-send-data.js","webpack://keksobooking/./source/js/preview-avatar-background.js","webpack://keksobooking/./source/js/form.js","webpack://keksobooking/./source/js/filter-map-form.js","webpack://keksobooking/./source/js/main.js"],"names":["changeAttribute","item","attr","value","setAttribute","showAlert","message","alertContainer","document","createElement","style","zIndex","position","left","top","width","height","transform","padding","fontSize","textAlign","backgroundColor","textContent","body","append","setTimeout","remove","isEscEvent","evt","key","similarCardTemplate","querySelector","content","mapWrapper","map","L","mainPinIcon","icon","iconUrl","iconSize","iconAnchor","mainPinMarker","marker","lat","lng","draggable","simplePinIcon","inputAddress","markers","createPointsOnMap","array","slice","forEach","point","location","addTo","bindPopup","element","popupElement","cloneNode","arrayItem","newElement","src","author","avatar","innerHTML","offer","title","address","firstChild","price","type","rooms","guests","checkin","checkout","description","fillPopupElement","popupFeatures","features","length","featureItem","featureItemTemplate","insertAdjacentHTML","renderFeaturesElemnts","popupPhotos","photos","popupPhoto","index","photoTemplate","renderPhotosElemnts","createPopupELement","keepInView","push","getData","getUrl","onSuccess","onFail","fetch","method","credentials","then","response","ok","json","Error","status","statusText","data","catch","err","FILE_TYPES","avatarFileChooser","avatarPreview","offerFileChooser","offerImgPreview","adFormFieldsets","querySelectorAll","buttonResetAdForm","mapForm","mapFormSelects","mapFormFieldsets","roomsSelect","capacitySelect","makeFormsDisabled","classList","add","fieldset","select","makeAddFormsActive","removeAttribute","selectType","inputPrice","getPriceOfType","timeIn","timeOut","syncSelectValue","select1","select2","addEventListener","options","i","selected","errorMessageTemplate","mainContentWrap","onEscKeydownCloseError","preventDefault","closePopupError","removeEventListener","onBtnCloseError","target","showErrorPopupMessage","messageElement","succeessMessageTemplate","closeSuccessPopup","onEscKeydownCloseSuccess","onClickCloseSuccess","onResetForm","reset","setLatLng","backgroundImage","mapFiltersForm","houseTypeFilter","housePriceFilter","houseRoomsFilter","houseGuestsFilter","getFilteredItem","filterByType","filterByPrice","checkedFeatures","feature","includes","filterByFeatures","Number","filterByRooms","filterByGuests","getURL","getDataSuccess","_","debounce","filteredItems","filter","renderFilteredArray","onSuccessSubmit","showSuccessPopupMessage","sendURL","on","input","tileLayer","attribution","addressXY","getLatLng","a","toFixed","b","setView","error","loadMap","mainSelect","selectToSync","option","syncSelects","sendUrl","sendData","FormData","file","files","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","result","readAsDataURL","backgroundSize"],"mappings":"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","file":"main.bundle.js","sourcesContent":["// проверка типа жилья\nconst checkHouseType = function (element) {\n  if (element.offer.type === 'flat') {\n    return 'Квартира';\n  }\n  if (element.offer.type === 'bungalow') {\n    return 'Бунгало';\n  }\n  if (element.offer.type === 'palace') {\n    return 'Дворец';\n  }\n  if (element.offer.type === 'house') {\n    return 'Дом';\n  }\n};\n\nconst changeAttribute = (item, attr, value) => {\n  item.setAttribute(attr, value);\n};\n\nconst showAlert = (message) => {\n  const alertContainer = document.createElement('div');\n  alertContainer.style.zIndex = 1000;\n  alertContainer.style.position = 'absolute';\n  alertContainer.style.left = '50%';\n  alertContainer.style.top = '50%';\n  alertContainer.style.width = '320px';\n  alertContainer.style.height = 'auto';\n  alertContainer.style.transform = 'translate(-50%, -50%)';\n  alertContainer.style.padding = '10px 3px';\n  alertContainer.style.fontSize = '30px';\n  alertContainer.style.textAlign = 'center';\n  alertContainer.style.backgroundColor = 'tomato';\n\n  alertContainer.textContent = message;\n\n  document.body.append(alertContainer);\n\n  setTimeout(() => {\n    alertContainer.remove();\n  }, 5000);\n};\n\nconst isEscEvent = (evt) => {\n  return evt.key === ('Escape' || 'Esc');\n};\n\nexport { checkHouseType, changeAttribute, showAlert, isEscEvent };\n","import { checkHouseType } from './util.js';\n// html шаблон который будем копировать\nconst similarCardTemplate = document.querySelector('#card').content.querySelector('.popup');\n// функция вставки доступных удобств\nconst renderFeaturesElemnts = (arrayItem, item) => {\n  const popupFeatures = item.querySelector('.popup__features');\n  if (arrayItem.offer.features.length === 0) {\n    popupFeatures.remove();\n  }\n  arrayItem.offer.features.forEach((featureItem) => {\n    const featureItemTemplate = `<li class=\"popup__feature popup__feature--${featureItem}\"></li>`;\n    popupFeatures.insertAdjacentHTML('beforeend', featureItemTemplate);\n  });\n};\n// функция вставки изображений объявления\nconst renderPhotosElemnts = (arrayItem, item) => {\n  const popupPhotos = item.querySelector('.popup__photos');\n  if (arrayItem.offer.photos.length === 0) {\n    popupPhotos.remove();\n  }\n  arrayItem.offer.photos.forEach((popupPhoto, index) => {\n    const photoTemplate = `<img src=\"${popupPhoto}\" class=\"popup__photo\" width=\"45\" height=\"40\" alt=\"Фотография жилья ${index + 1}\">`;\n    popupPhotos.insertAdjacentHTML('beforeend', photoTemplate);\n  });\n};\n\nconst fillPopupElement = (arrayItem, newElement) => {\n  // заполняем данными конкертного объекта\n  newElement.querySelector('.popup__avatar').src = arrayItem.author.avatar;\n  newElement.querySelector('.popup__features').innerHTML = '';\n  newElement.querySelector('.popup__title').textContent = arrayItem.offer.title;\n  newElement.querySelector('.popup__text--address').textContent = arrayItem.offer.address;\n  // newElement.querySelector('.popup__text--price').innerHTML = arrayItem.offer.price + ' <span>₽/ночь</span>';\n  newElement.querySelector('.popup__text--price').firstChild.textContent = arrayItem.offer.price + ' ';\n  newElement.querySelector('.popup__type').textContent = checkHouseType(arrayItem);\n  newElement.querySelector('.popup__text--capacity').textContent = `${arrayItem.offer.rooms} команты для ${arrayItem.offer.guests} гостей`;\n  newElement.querySelector('.popup__text--time').textContent = `Заезд после ${arrayItem.offer.checkin}, выезд до ${arrayItem.offer.checkout}`;\n  newElement.querySelector('.popup__description').textContent = arrayItem.offer.description;\n  newElement.querySelector('.popup__photos').innerHTML = '';\n  return newElement;\n};\n\n// функция генерации одного элемента\nconst createPopupELement = (element) => {\n  const popupElement = similarCardTemplate.cloneNode(true);\n  fillPopupElement(element, popupElement);\n  renderFeaturesElemnts(element, popupElement);\n  renderPhotosElemnts(element, popupElement);\n  return popupElement;\n};\n\nexport { createPopupELement };\n","/*global L:readonly*/\nimport { makeFormsDisabled, makeAddFormsActive } from './form.js';\nimport { showAlert } from './util.js';\nimport { createPopupELement } from './popup.js';\n\nconst OFFER_QUANTITY = 10;\n\nconst mapWrapper = document.querySelector('#map-canvas');\nconst map = L.map(mapWrapper);\n\n// иконка главной метки\nconst mainPinIcon = L.icon({\n  iconUrl: 'img/main-pin.svg',\n  iconSize: [52, 52],\n  iconAnchor: [26, 52],\n});\n// главная метка\nconst mainPinMarker = L.marker(\n  {\n    lat: 35.6817,\n    lng: 139.753882,\n  },\n  {\n    draggable: true,\n    icon: mainPinIcon,\n  },\n);\n// метки объявлений\nconst simplePinIcon = L.icon({\n  iconUrl: 'img/pin.svg',\n  iconSize: [40, 40],\n  iconAnchor: [20, 40],\n});\n// инпут в который вставляем геоданные главной метки\nconst adForm = document.querySelector('.ad-form');\nconst inputAddress = adForm.querySelector('#address');\n// функция получения координат метки при заверешении ее перемещения и вставки данных в инпут\nconst movePinPasteLocation = (pin, input) => {\n  pin.on('moveend', (evt) => {\n    const addressXY = evt.target.getLatLng();\n    const a = addressXY.lat.toFixed(5);\n    const b = addressXY.lng.toFixed(5);\n    input.value = `${a}, ${b}`;\n  });\n};\n\nconst initMap = () => {\n  L.tileLayer(\n    'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n    {\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n    },\n  ).addTo(map);\n\n  // добавлние главной метки на карту\n  mainPinMarker.addTo(map);\n  movePinPasteLocation(mainPinMarker, inputAddress);\n};\n\nconst loadMap = () => {\n  try {\n    map.on('load', () => {\n      makeAddFormsActive();\n      initMap();\n    })\n      .setView({\n        lat: 35.6817,\n        lng: 139.75388,\n      }, 13);\n  } catch (error) { showAlert(error); makeFormsDisabled() }\n};\n\nconst markers = [];\n// функция получения меток из массива данных\nconst createPointsOnMap = (array) => {\n  array.slice(0, OFFER_QUANTITY).forEach((point) => {\n    const marker = L.marker(\n      {\n        lat: point.location.lat,\n        lng: point.location.lng,\n      },\n      {\n        icon: simplePinIcon,\n      },\n    );\n    marker\n      .addTo(map)\n      .bindPopup(\n        createPopupELement(point),\n        {\n          keepInView: true,\n        });\n    markers.push(marker)\n  });\n};\n\nconst resetMarkers = () => {\n  markers.forEach(marker => {\n    marker.addTo(map);\n  });\n};\n\nconst deleteMarker = () => {\n  markers.forEach(marker => {\n    marker.remove();\n  });\n};\n\n\nconst setPositionMainPin = () => {\n  mainPinMarker.setLatLng([35.6817, 139.753882])\n};\n\nexport { createPointsOnMap, deleteMarker, loadMap, setPositionMainPin, resetMarkers }\n","const getData = (getUrl, onSuccess, onFail) => {\n  return fetch(getUrl,\n    {\n      method: 'GET',\n      credentials: 'same-origin',\n    },\n  )\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      }\n\n      throw new Error(`${response.status} ${response.statusText}`);\n    })\n    .then((data) => {\n      onSuccess(data);\n    })\n    .catch((err) => {\n      onFail(err);\n    });\n};\n\nconst sendData = (sendUrl, body, onSuccess, onFail) => {\n  return fetch(sendUrl,\n    {\n      method: 'POST',\n      body,\n    },\n  )\n    .then((response) => {\n      if (response.ok) {\n        onSuccess();\n      } else {\n        onFail();\n      }\n    })\n    .catch(() => {\n      onFail();\n    });\n};\n\nexport { getData, sendData };\n","const FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst avatarFileChooser = document.querySelector('#avatar');\nconst avatarPreview = document.querySelector('.ad-form-header__preview > img');\nconst offerFileChooser = document.querySelector('#images');\nconst offerImgPreview = document.querySelector('.ad-form__photo');\n\nconst setPreviewUploadAvatar = () => {\n  avatarFileChooser.addEventListener('change', () => {\n    const file = avatarFileChooser.files[0];\n    const fileName = file.name.toLowerCase();\n\n    const matches = FILE_TYPES.some((it) => {\n      return fileName.endsWith(it);\n    });\n\n    if (matches) {\n      const reader = new FileReader();\n\n      reader.addEventListener('load', () => {\n        avatarPreview.src = reader.result;\n      });\n\n      reader.readAsDataURL(file);\n    }\n  });\n};\n\nconst setPreviewUploadImg = () => {\n  offerFileChooser.addEventListener('change', () => {\n    const file = offerFileChooser.files[0];\n    const fileName = file.name.toLowerCase();\n\n    const matches = FILE_TYPES.some((it) => {\n      return fileName.endsWith(it);\n    });\n\n    if (matches) {\n      const reader = new FileReader();\n      reader.addEventListener('load', () => {\n        offerImgPreview.style.backgroundImage = `url('${reader.result}')`;\n        offerImgPreview.style.backgroundSize = 'cover';\n      });\n\n      reader.readAsDataURL(file);\n    }\n  });\n};\n\nconst resetImageSrc = () => {\n  avatarPreview.src = 'img/muffin-grey.svg';\n};\n\nconst resetBackgroundPreview = () => {\n  offerImgPreview.style.backgroundImage = '';\n};\n\nexport { setPreviewUploadAvatar, setPreviewUploadImg, resetImageSrc, resetBackgroundPreview };\n","import { changeAttribute, isEscEvent } from './util.js'\nimport { setPositionMainPin, resetMarkers } from './map.js';\nimport { sendData } from './get-send-data.js';\nimport { resetImageSrc, resetBackgroundPreview } from './preview-avatar-background.js';\n\nconst adForm = document.querySelector('.ad-form');\nconst adFormFieldsets = adForm.querySelectorAll('fieldset');\nconst buttonResetAdForm = document.querySelector('.ad-form__reset');\nconst mapForm = document.querySelector('.map__filters');\nconst mapFormSelects = mapForm.querySelectorAll('select');\nconst mapFormFieldsets = mapForm.querySelectorAll('fieldset');\nconst roomsSelect = document.querySelector('#room_number');\nconst capacitySelect = document.querySelector('#capacity');\n//////////// активация/дезактивация форм\nconst makeFormsDisabled = () => {\n  adForm.classList.add('ad-form--disabled');\n  adFormFieldsets.forEach(fieldset => {\n    fieldset.setAttribute('disabled', 'disabled')\n  });\n  mapForm.classList.add('map__filters--disabled');\n  mapFormFieldsets.forEach(fieldset => {\n    fieldset.setAttribute('disabled', 'disabled')\n  });\n  mapFormSelects.forEach(select => {\n    select.setAttribute('disabled', 'disabled')\n  });\n};\n\nconst makeAddFormsActive = () => {\n  adForm.classList.remove('ad-form--disabled');\n  adFormFieldsets.forEach(fieldset => {\n    fieldset.removeAttribute('disabled')\n  });\n};\n\nconst makeMapFormsActive = () => {\n  mapForm.classList.remove('map__filters--disabled');\n  mapFormFieldsets.forEach(fieldset => {\n    fieldset.removeAttribute('disabled')\n  });\n  mapFormSelects.forEach(select => {\n    select.removeAttribute('disabled')\n  });\n};\n//////////////////// синхнориназция типа жилья и его цены\nconst selectType = document.querySelector('#type');\nconst inputPrice = document.querySelector('#price');\nconst getPriceOfType = () => {\n  if (selectType.value === 'bungalow') {\n    return '0';\n  }\n  if (selectType.value === 'flat') {\n    return '1000';\n  }\n  if (selectType.value === 'palace') {\n    return '10000';\n  }\n  if (selectType.value === 'house') {\n    return '5000';\n  }\n};\n\nconst setInputMinPrice = () => {\n  changeAttribute(inputPrice, 'placeholder', getPriceOfType());\n  changeAttribute(inputPrice, 'min', getPriceOfType());\n  selectType.addEventListener('change', () => {\n    changeAttribute(inputPrice, 'placeholder', getPriceOfType());\n    changeAttribute(inputPrice, 'min', getPriceOfType());\n  });\n};\n///////////////////////////// синзронизация врмени заезда/выезда\nconst timeIn = document.querySelector('#timein');\nconst timeOut = document.querySelector('#timeout');\n\nconst syncSelectValue = (select1, select2) => {\n  select1.addEventListener('change', () => {\n    let options = select2.options;\n    for (let i = 0; i < options.length; i++) {\n      if (options[i].value === select1.value) {\n        options[i].selected = true;\n      }\n    }\n  })\n};\n\nconst syncCheckTime = () => {\n  syncSelectValue(timeIn, timeOut);\n  syncSelectValue(timeOut, timeIn);\n};\n///////////// синхронизация кол-ва комнат и жильцов\nconst syncSelects = (mainSelect, selectToSync) => {\n  const options = selectToSync.options;\n\n  if (mainSelect.value === '1') {\n    for (let index = 0; index < options.length; index++) {\n      const option = options[index];\n      if (option.value !== '1') {\n        option.selected = false;\n        option.setAttribute('disabled', 'disabled');\n      } else {\n        option.removeAttribute('disabled', 'disabled');\n        option.selected = true;\n      }\n    }\n  }\n\n  if (mainSelect.value === '2') {\n    for (let index = 0; index < options.length; index++) {\n      const option = options[index];\n      if (option.value === '1' || option.value === '2') {\n        option.selected = true;\n        option.removeAttribute('disabled', 'disabled');\n      } else {\n        option.setAttribute('disabled', 'disabled');\n        option.selected = false;\n      }\n    }\n  }\n\n  if (mainSelect.value === '3') {\n    for (let index = 0; index < options.length; index++) {\n      const option = options[index];\n      if (option.value === '0') {\n        option.selected = false;\n        option.setAttribute('disabled', 'disabled');\n      } else {\n        option.removeAttribute('disabled', 'disabled');\n        option.selected = true;\n      }\n    }\n  }\n\n  if (mainSelect.value === '100') {\n    for (let index = 0; index < options.length; index++) {\n      const option = options[index];\n      if (option.value === '0') {\n        option.selected = true;\n        option.removeAttribute('disabled', 'disabled');\n      } else {\n        option.setAttribute('disabled', 'disabled');\n        option.selected = true;\n      }\n    }\n  }\n};\nconst setRoomsSelectListener = () => {\n  roomsSelect.addEventListener('change', () => {\n    syncSelects(roomsSelect, capacitySelect);\n  });\n};\n\n//////// показ и скрытие сообщени при неусешной отправки формы\nconst errorMessageTemplate = document.querySelector('#error').content.querySelector('.error');\nconst mainContentWrap = document.querySelector('main')\n\nconst onEscKeydownCloseError = (evt) => {\n  if (isEscEvent(evt)) {\n    evt.preventDefault();\n    closePopupError();\n  }\n};\n\nconst closePopupError = () => {\n  document.querySelector('.error').remove();\n  document.removeEventListener('keydown', onEscKeydownCloseError);\n};\n\nconst onBtnCloseError = (evt) => {\n  closePopupError();\n  evt.target.removeEventListener('click', onBtnCloseError);\n};\n\nconst showErrorPopupMessage = () => {\n  const messageElement = errorMessageTemplate.cloneNode(true);\n  mainContentWrap.append(messageElement);\n  const closeErrPopupBtn = document.querySelector('.error__button');\n  closeErrPopupBtn.addEventListener('click', onBtnCloseError);\n  document.addEventListener('keydown', onEscKeydownCloseError);\n};\n\n//////// показ и скрытие сообщени при усешной отправки формы\nconst succeessMessageTemplate = document.querySelector('#success').content.querySelector('.success');\n\nconst closeSuccessPopup = () => {\n  document.querySelector('.success').remove();\n  document.removeEventListener('keydown', onEscKeydownCloseSuccess);\n  document.removeEventListener('click', onClickCloseSuccess);\n};\n\nconst onClickCloseSuccess = () => {\n  closeSuccessPopup();\n};\n\nconst onEscKeydownCloseSuccess = (evt) => {\n  if (isEscEvent(evt)) {\n    evt.preventDefault();\n    closeSuccessPopup();\n  }\n};\n\nconst onResetForm = () => {\n  adForm.reset();\n  mapForm.reset();\n  setPositionMainPin();\n  resetImageSrc();\n  resetBackgroundPreview();\n  resetMarkers();\n};\n\nconst showSuccessPopupMessage = () => {\n  const messageElement = succeessMessageTemplate.cloneNode(true);\n  mainContentWrap.append(messageElement);\n  document.addEventListener('keydown', onEscKeydownCloseSuccess);\n  document.addEventListener('click', onClickCloseSuccess);\n  onResetForm();\n};\n///////// отправка формы нового объяаления\nconst submitForm = (sendURL, onSuccess, onFail) => {\n  adForm.addEventListener('submit', (evt) => {\n    evt.preventDefault();\n    sendData(sendURL, new FormData(evt.target), onSuccess, onFail);\n  });\n};\n///////сброс формы по клику\nconst onBtnResetAddFormListener = () => {\n  buttonResetAdForm.addEventListener('click', () => {\n    onResetForm();\n  });\n};\n\nexport { makeFormsDisabled, makeAddFormsActive, makeMapFormsActive, setInputMinPrice, syncCheckTime, syncSelects, showErrorPopupMessage, showSuccessPopupMessage, submitForm, onBtnResetAddFormListener, setRoomsSelectListener, onResetForm }\n","/* global _:readonly */\nimport { createPointsOnMap, deleteMarker } from './map.js';\n\nconst RERENDER_DELAY = 500;\nconst PRICE_LOW = 10000;\nconst PRICE_HIGH = 50000;\n\nconst mapFiltersForm = document.querySelector('.map__filters');\nconst houseTypeFilter = mapFiltersForm.querySelector('#housing-type');\nconst housePriceFilter = mapFiltersForm.querySelector('#housing-price');\nconst houseRoomsFilter = mapFiltersForm.querySelector('#housing-rooms');\nconst houseGuestsFilter = mapFiltersForm.querySelector('#housing-guests');\n\nconst filterByType = (item) => {\n  return houseTypeFilter.value === 'any' || item.offer.type === houseTypeFilter.value;\n};\n\nconst filterByPrice = (item) => {\n  if (housePriceFilter.value === 'any') {\n    return true;\n  } else if (housePriceFilter.value === 'middle') {\n    return item.offer.price >= PRICE_LOW && item.offer.price < PRICE_HIGH;\n  } else if (housePriceFilter.value === 'low') {\n    return item.offer.price < PRICE_LOW;\n  } else if (housePriceFilter.value === 'high') {\n    return item.offer.price >= PRICE_HIGH;\n  } return false;\n};\n\nconst filterByFeatures = (item) => {\n  const checkedFeatures = mapFiltersForm.querySelectorAll('.map__checkbox:checked');\n  if (checkedFeatures.length === 0) {\n    return true;\n  }\n  for (let feature of checkedFeatures) {\n    if (!item.offer.features.includes(feature.value)) {\n      return false;\n    }\n  }\n  return true;\n};\n\nconst filterByRooms = (item) => {\n  return houseRoomsFilter.value === 'any' || item.offer.rooms === Number(houseRoomsFilter.value);\n};\n\nconst filterByGuests = (item) => {\n  return houseGuestsFilter.value === 'any' || item.offer.guests === Number(houseGuestsFilter.value)\n};\n\nconst getFilteredItem = (item) => {\n  return filterByType(item) && filterByPrice(item) && filterByFeatures(item) && filterByRooms(item) && filterByGuests(item);\n};\n\nconst renderFilteredArray = (array) => {\n  const filteredItems = array.filter(getFilteredItem)\n  deleteMarker();\n  createPointsOnMap(filteredItems);\n};\n\nconst filterMapForm = (array) => {\n  mapFiltersForm.addEventListener('change', _.debounce(() =>\n    renderFilteredArray(array), RERENDER_DELAY,\n  ));\n};\n\nexport { filterMapForm };\n","import { showAlert } from './util.js';\nimport { setInputMinPrice, setRoomsSelectListener, syncCheckTime, makeFormsDisabled, makeMapFormsActive, submitForm, showSuccessPopupMessage, showErrorPopupMessage, onBtnResetAddFormListener } from './form.js';\nimport { loadMap, createPointsOnMap } from './map.js';\nimport { getData } from './get-send-data.js';\nimport { filterMapForm } from './filter-map-form.js';\nimport { setPreviewUploadAvatar, setPreviewUploadImg } from './preview-avatar-background.js';\n\nconst sendURL = 'https://22.javascript.pages.academy/keksobooking';\nconst getURL = 'https://22.javascript.pages.academy/keksobooking/data';\n\nmakeFormsDisabled();\n\nconst getDataSuccess = (data) => {\n  createPointsOnMap(data);\n  filterMapForm(data);\n  makeMapFormsActive();\n};\n\nconst onSuccessSubmit = () => {\n  showSuccessPopupMessage();\n  getData(getURL, getDataSuccess, showAlert);\n};\n\ndocument.addEventListener('DOMContentLoaded', () => {\n\n  loadMap();\n  getData(getURL, getDataSuccess, showAlert);\n\n  setInputMinPrice();\n  syncCheckTime();\n  setRoomsSelectListener();\n\n  submitForm(sendURL, onSuccessSubmit, showErrorPopupMessage);\n  onBtnResetAddFormListener();\n\n  setPreviewUploadAvatar();\n  setPreviewUploadImg();\n});\n"],"sourceRoot":""}